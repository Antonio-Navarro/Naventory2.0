<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:sec="http://www.springframework.org/security/tags"
	template="../../WEB-INF/templates/templateApp.xhtml">


	<ui:param name="focusme" value="filterInput" />
	<ui:param name="focusRendered" value="true" />


	<ui:param name="targetDefaultCommand" value="filterButton" />
	<ui:param name="defaultCommandRendered" value="true" />

	<ui:define name="body">
		<div class="row">
			<div class="col-md-12">
				<h1>
					<i class="fa fa-users iconTitle"></i>
					<h:outputText value="#{msg['users.form.title']}" />
				</h1>
			</div>
		</div>
		<div class="clearfix"></div>
		<div class="separator"></div>
		<div class="row">
			<div class="col-md-12">
				<div class="row">
					<ui:include src="../usersFilter.xhtml" />
				</div>
				<div class="row">
					<div class="col-md-3">
						<div class="text-left">
							<p:commandButton value="#{msg['newEntity']}" global="false"
								icon="fa fa-user-plus" actionListener="#{usuarioBean.newUser}"
								oncomplete="PF('userDetailsDialog').show();"
								update="userDetailsModal" />
						</div>
					</div>
				</div>
				<div class="row" style="margin-top: 1%;">
					<div class="col-md-12">
						<p:dataTable id="userTable" var="user"
							value="#{administracionBean.usuarios}" paginator="true"
							rows="#{defaultPaginatorRows}" reflow="true" rowIndexVar="cont"
							paginatorPosition="bottom" lazy="true" resizableColumns="true"
							rowsPerPageTemplate="#{defaultRowsPerTemplate}"
							emptyMessage="#{msg['noresult']}">

							<f:facet name="footer">
								<div class="text-left">
									<h:outputFormat value="#{msg['numResult']}">
										<f:param value="5"></f:param>
									</h:outputFormat>
								</div>
							</f:facet>
							<p:column sortBy="#{cont+1}" headerText="" style="width:5%">
								<h:outputText value="#{cont}" />
							</p:column>
							<p:column sortBy="#{user.nombre}"
								headerText="#{msg['users.datatable.header.nombre']}">
								<h:outputText value="#{user.nombre}" />
							</p:column>
							<p:column sortBy="#{user.apellidos}"
								headerText="#{msg['users.datatable.header.apellidos']}">
								<h:outputText value="#{user.apellido}" />
							</p:column>
							<p:column sortBy="#{user.email}"
								headerText="#{msg['users.datatable.header.email']}">
								<h:outputText value="#{user.email}" />
							</p:column>
							<p:column sortBy="#{user.activo}" style="width:10%"
								headerText="#{msg['users.datatable.header.activo']}">
								<p:outputLabel value="Sí" rendered="#{user.activo eq 'Y'}"></p:outputLabel>
								<p:outputLabel value="No"
									rendered="#{user.activo == 'N' || user.activo eq null }"></p:outputLabel>
							</p:column>
							<p:column sortBy="#{user.admin}" style="width:10%"
								headerText="#{msg['users.datatable.header.administrador']}">
								<p:outputLabel value="Sí" rendered="#{user.admin eq 'Y'}"></p:outputLabel>
								<p:outputLabel value="No"
									rendered="#{user.admin == 'N' || user.admin eq null }"></p:outputLabel>

							</p:column>

							<p:column width="8%"
								headerText="#{msg['users.datatable.header.opciones']}">
								<p:commandButton title="#{msg['edit']}" global="false"
									icon="fa fa-pencil-square-o"
									actionListener="#{usuarioBean.editUser(user)}"
									oncomplete="PF('userDetailsDialog').show();"
									update="formApp:userDetailsModal" />
								<p:commandButton icon="fa fa-user-times"
									title="#{msg['delete']}"
									disabled="#{not usuarioBean.canDelete(user)}"
									actionListener="#{usuarioBean.delete(user)}" update="userTable">
									<p:confirm header="#{msg['needConfirmation']}"
										message="#{msg['areyousure']}" icon="fa fa-warning" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
					</div>
				</div>
			</div>
		</div>
		<ui:include src="../usersDetails.xhtml" />
	</ui:define>
</ui:composition>